/*  Code_Section_Detector_Java_Algorithm.cpp

   Copyright (C) 2008 Stephen Torri

   This file is part of Libreverse.

   Libreverse is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published
   by the Free Software Foundation; either version 3, or (at your
   option) any later version.

   Libreverse is distributed in the hope that it will be useful, but
   WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
   General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program.  If not, see
   <http://www.gnu.org/licenses/>.
*/

#include "Code_Section_Detector_Java_Algorithm.h"
#include "Code_Section_Detector.h"

#include "libreverse/io/File_ID.h"
#include "libreverse/io/input/File_Readers/Elf/Elf_Reader_64.h"
#include "libreverse/io/input/File_Readers/Elf/Elf_Header_64.h"

#include <boost/format.hpp>

#ifdef LIBREVERSE_DEBUG
#include "libreverse/Trace.h"
using namespace libreverse::api;
using namespace libreverse::trace;
#endif /* LIBREVERSE_DEBUG */

namespace libreverse { namespace component {

    meta::Meta_Object::ptr_t
    Code_Section_Detector_Java_Algorithm::run ( io_types::File_ID::const_ptr_t )
    {

#ifdef LIBREVERSE_DEBUG
      Trace::write_Trace ( TraceArea::COMPONENTS,
			   TraceLevel::DETAIL,
			   "Entering Code_Section_Detector_Java_Algorithm::run" );
#endif /* LIBREVERSE_DEBUG */

      /* NOTE: It is interesting to note that Elf and PE have only one
	 section that contains all their executable code. Java class
	 files do not. They have all the code for each function within
	 the Method Object. There we do not have a definitive address
	 where the code starts and how long it is.
       */
      meta::Meta_Object::ptr_t meta_ptr ( new meta::Meta_Object() );

      meta_ptr->add ( "code_section_address",
		      "none",
		      meta::Meta_Object::STRING );
      meta_ptr->add ( "code_section_size",
		      "none",
		      meta::Meta_Object::STRING );

#ifdef LIBREVERSE_DEBUG
      Trace::write_Trace ( TraceArea::COMPONENTS,
			   TraceLevel::DETAIL,
			   "Exiting Code_Section_Detector_Java_Algorithm::run" );
#endif /* LIBREVERSE_DEBUG */


      return meta_ptr;
    }

} /* namespace component */
} /* namespace libreverse */

