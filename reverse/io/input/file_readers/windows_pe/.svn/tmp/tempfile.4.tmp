#ifndef WPEF_DEBUG_DIRECTORY_H_
#define WPEF_DEBUG_DIRECTORY_H_

/*
  All comments and hexidecimal values in this header, marked with
  MS_PE_COFF, are taken from the Microsoft Portable Executable and //
  Common Object File Format - Revision 8, May 16, 2006.
*/

#include "Debug_Types.h"
#include "PE_Types.h"
#include <string>
#include "libreverse/io/input/File_Readers/Base_Header.h"
#include <boost/shared_ptr.hpp>

namespace libreverse { namespace wpef_module {

    class PE_Debug_Directory : public libreverse::header::Base_Header {
    public:

        friend class PE_File<32>;
        friend class PE_File<64>;

        PE_Debug_Directory ();

        virtual ~PE_Debug_Directory(){}

        /*!
         * \brief Return the bit size of this header
         * \return Bit size of header
         */
        virtual boost::uint32_t get_size (void) const;

        /*!
         * \brief Convert the header data into a string representation
         * \return String representation of header data
         */
        virtual std::string to_String (void);

        /*!
         * \brief Convert the bit order of the stored data
         */
        virtual void convert ();

    private:

        /*
          MS_PE_COFF: Reserved, must be 0.
        */
        boost::uint32_t m_characteristics;

        /*
          MS_PE_COFF: The time and date that the debug data was
          created.
        */
        boost::uint32_t m_time_date_stamp;

        /*
          MS_PE_COFF: The major version number. The major and minor
          version numbers can be set by the user.
        */
        boost::uint16_t m_major_version;

        /*
          MS_PE_COFF: The minor version number.
        */
        boost::uint16_t m_minor_version;

        /*
          MS_PE_COFF: The format of debugging information. This field
          enables support of multiple debuggers.
        */
        boost::uint32_t m_type;

        /*
          MS_PE_COFF: The size of the debug data
        */
        boost::uint32_t m_size_of_data;

        /*
          MS_PE_COFF: The address of the debug data when loaded,
          relative to the image base.
        */
        boost::uint32_t m_address_of_raw_data;

        /*
          MS_PE_COFF: The file pointer to the debug data.
        */
        boost::uint32_t m_pointer_to_raw_data;
    };

} /* namespace wpef_module */
} /* namespace libreverse */

#endif /* WPEF_DEBUG_DIRECTORY_H_ */
