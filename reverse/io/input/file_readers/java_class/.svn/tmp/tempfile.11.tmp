#ifndef JAVA_READER_H_
#define JAVA_READER_H_

#include "libreverse/io/input/File_Readers/File_Reader.h"
#include "libreverse/io/IO_Types.h"
#include "Java_Types.h"

namespace libreverse { namespace java_module {

    /*!
     * \class Reader
     * \date 2003
     * \author Stephen Torri
     */
    class Reader : public io::File_Reader {
    public:

        /*!
         * \brief Default Constructor
         * \param target_file The file to be used for decompiling
         */
        Reader ( io_types::File_ID::ptr_t target_file );

        /*!
         * \brief Default Destructor
         */
        virtual ~Reader();

        virtual bool support_File_Type ( void );

        virtual std::string get_Meta_Info ( File_Reader::Action index,
                                            std::string name = "" );

        virtual void read_Headers ( void );

        virtual data_types::Memory_Map::ptr_t get_Memory_Map ( void );

        /*!
         * \brief Print out the entire file contents
         */
        virtual std::string to_String (void);

        /*!
         * \brief Get human readable strings
         */
        virtual io_types::Text_Data::data_type get_Text_Strings (void);

        /*!
         * \brief Get UTF-16 strings
         */
        virtual io_types::Text_Data::data_type get_UTF16_Strings (void);

        virtual std::string get_Section_String ( std::string name ) const;

        java_types::Class_Header::ptr_t get_Header (void);

    private:

        /*!
         * \brief Return the File Type of the target file
         */
        std::string get_File_Type (void) const;

        /*
         * !\brief Return the Architecture Type of the target file
         */
        std::string get_Arch_Type (void) const;

        /*---------------
         *   Variables
         *---------------*/
        /*! \brief JAVA File handle */
        java_types::Class_File::ptr_t m_file;

        java_types::Header::ptr_t m_hdr_ptr;

    public:

        /*---------------
         *   Functions
         *---------------*/

        /*!
         * \brief Get the JAVA Header from the file
         */
        void read_Class_Header (void);

    };

} /* namespace java_module */
} /* namespace libreverse */

#endif /* JAVA_READER_H_ */
