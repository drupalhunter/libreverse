/*  Reader.h

   Copyright (C) 2008 Stephen Torri

   This file is part of Libreverse.

   Libreverse is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published
   by the Free Software Foundation; either version 3, or (at your
   option) any later version.

   Libreverse is distributed in the hope that it will be useful, but
   WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
   General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program.  If not, see
   <http://www.gnu.org/licenses/>.
*/

#ifndef JAVA_READER_H_
#define JAVA_READER_H_

#include "libreverse/io/input/File_Readers/File_Reader.h"
#include "libreverse/io/IO_Types.h"
#include "Java_Types.h"

namespace libreverse { namespace java_module {

    /*!
     * \class Reader
     * \date 2003
     * \author Stephen Torri
     */
    class Reader : public io::File_Reader {
    public:

        /*!
         * \brief Default Constructor
         * \param target_file The file to be used for decompiling
         */
        Reader ( io_types::File_ID::const_ptr_t target_file );

        /*!
         * \brief Default Destructor
         */
        virtual ~Reader();

        virtual bool support_File_Type ( void );

        virtual void read_Headers ( void );

        virtual data_types::Memory_Map::ptr_t get_Memory_Map ( void );

        /*!
         * \brief Print out the entire file contents
         */
        virtual std::string to_String (void);

        /*!
         * \brief Get human readable strings
         */
        virtual io_types::Text_Data::data_type get_Text_Strings (void);

        /*!
         * \brief Get UTF-16 strings
         */
        virtual io_types::Text_Data::data_type get_UTF16_Strings (void);

        virtual std::string get_Section_String ( std::string name ) const;

        java_types::Class_Header::ptr_t get_Header (void);

        /*!
         * \brief Return the File Type of the target file
         */
        virtual std::string get_File_Type (void);

        /*
         * !\brief Return the Architecture Type of the target file
         */
        std::string get_Arch_Type (void) const;

    private:

        /*---------------
         *   Variables
         *---------------*/
        /*! \brief JAVA File handle */
        java_types::Class_File::ptr_t m_file;

        java_types::Header::ptr_t m_hdr_ptr;

    public:

        /*---------------
         *   Functions
         *---------------*/

        /*!
         * \brief Get the JAVA Header from the file
         */
        void read_Class_Header (void);

    };

} /* namespace java_module */
} /* namespace libreverse */

#endif /* JAVA_READER_H_ */
